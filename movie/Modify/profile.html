<!--
=========================================================
* Argon Design System - v1.2.0
=========================================================

* Product Page: https://www.creative-tim.com/product/argon-design-system
* Copyright 2020 Creative Tim (http://www.creative-tim.com)

Coded by www.creative-tim.com

=========================================================

* The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software. -->
<!DOCTYPE html>
<html lang="en">
{% load static %}

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
   <link rel="apple-touch-icon" sizes="76x76" href="{% static "/assets/img/apple-icon.png" %}">
  <link rel="icon" type="image/png" href="{% static  "./assets/img/favicon.png" %}">
  <title>
QUICK BOOK
  </title>
   <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700" rel="stylesheet">
  <link href="https://use.fontawesome.com/releases/v5.0.6/css/all.css" rel="stylesheet">
  <!-- Nucleo Icons -->
  <link href="{% static "/assets/css/nucleo-icons.css" %}" rel="stylesheet" />
  <link href="{% static "/assets/css/nucleo-svg.css" %}" rel="stylesheet" />
  <!-- Font Awesome Icons -->
  <link href="{% static "/assets/css/font-awesome.css" %}" rel="stylesheet" />
  <link href="{% static "/assets/css/nucleo-svg.css" %}" rel="stylesheet" />
  <!-- CSS Files -->
  <link href="{% static "/assets/css/argon-design-system.css" %}" rel="stylesheet" />
<style type="text/css">
  #bookticket
  {
    background-color: white;
    margin:auto;
    padding-top: 50px;
  }
 
</style>
</head>

<body class="profile-page">
  <!-- Navbar -->
  
<nav class="navbar navbar-expand-lg navbar-dark bg-default">
    <div class="container">
        <a class="navbar-brand " href="#">
        <img src="{% static "/assets/img/brand/white.png" %}">
      </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-default" aria-controls="navbar-default" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
            

        <div class="collapse navbar-collapse" id="navbar-default">
            <div class="navbar-collapse-header">
                <div class="row">
                    <div class="col-6 collapse-brand">
                        <a href="javascript:void(0)">
                            <img src="{% static "/assets/img/brand/blue.png" %}">
                        </a>
                    </div>
                    <div class="col-6 collapse-close">
                        <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-default" aria-controls="navbar-default" aria-expanded="false" aria-label="Toggle navigation">
                            <span></span>
                            <span></span>
                        </button>
                    </div>
                </div>
            </div>

            
            <ul class="navbar-nav ml-rg-auto">
                <li class="nav-item">
                    <a class="nav-link nav-link-icon" href="#">
                        <i class="ni ni-money-coins"></i>
                        <span  class="nav-link-inner--text">QBOOK BALANCE:RS {{wallet}}</span>
                    </a>
                </li>
     
               <li class="nav-item dropdown">
            <a href="#" class="nav-link" data-toggle="dropdown" href="#" role="button">
              <i class="ni ni-ui-04 d-lg"></i>
              <span class="nav-link-inner--text">PROFILE</span>
            </a>
            <div class="dropdown-menu dropdown-menu-xl">
              <div class="dropdown-menu-inner">
                <a href="#" class="media d-flex align-items-center">
                  <div class="icon icon-shape bg-gradient-primary rounded-circle text-white">
                    <i class="ni ni-spaceship"></i>
                  </div>
                  <div class="media-body ml-3">
                    <h6 class="heading text-primary mb-md-1">NAME</h6>
                    <p class="description d-none d-md-inline-block mb-0">{{name}}</p>
                  </div>
                </a>
                <a href="#" class="media d-flex align-items-center" >
                  <div class="icon icon-shape bg-gradient-success rounded-circle text-white">
                    <i class="ni ni-palette"></i>
                  </div>
                  <div class="media-body ml-3">
                    <h6 class="heading text-primary mb-md-1">EMAIL</h6>
                    <p class="description d-none d-md-inline-block mb-0">{{email}}</p>
                  </div>
                </a>
                <a href="#" class="media d-flex align-items-center" onclick="changemobile()">
                  <div class="icon icon-shape bg-gradient-warning rounded-circle text-white">
                    <i class="ni ni-ui-04"></i>
                  </div>
                  <div class="media-body ml-3">
                    <h5 class="heading text-warning mb-md-1">MOBILE NUMBER</h5>
                    <h5 class="heading text-warning mb-md-2">EDIT &nbsp;<i class="fa fa-pencil-square-o" aria-hidden="true"></i></h5>
                    <p class="description d-none d-md-inline-block mb-0">{{mobile}}</p>
                  </div>
                </a>
                 <a href="#" class="media d-flex align-items-center" data-toggle="modal" data-target="#modal-default">
                  <div class="icon icon-shape bg-gradient-success rounded-circle text-white">
                    <i class="ni ni-atom"></i>
                  </div>
                  <div class="media-body ml-3">
                    <h6 class="heading text-primary mb-md-1">PASSWORD</h6>
                        <h5 class="heading text-primary mb-md-1">EDIT &nbsp;<i class="fa fa-pencil-square-o" aria-hidden="true"></i></h5>
                    <p class="description d-none d-md-inline-block mb-0">******</p>
                  </div>
                </a>
         
      
              </div>
            </div>
          </li>
            </ul>
              <ul class="navbar-nav align-items-lg-center ml-lg-auto">
                     <li class="nav-item">  
 <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#modalRelatedContent">
                        <i class="ni ni-briefcase-24"></i>
                        TICKETS<span class="badge badge-default" id="totalnoofticketsbooked">
                        </span>
</button>
</li>
          <li class="nav-item  d-lg-block ml-lg-4">
            <a href="#"  class="btn btn-neutral btn-icon">
              <span class="btn-inner--icon">
                <i class="ni ni-circle-08"></i>
              </span>
              <span class="nav-link-inner--text">{{name}}</span>
            </a>
            <a href="\LOGOUT\" class="btn btn-neutral btn-icon">
              <span class="btn-inner--icon">
                <i class="ni ni-curved-next"></i>
              </span>
              <span class="nav-link-inner--text">LOGOUT</span>
            </a>
          </li>
        </ul>        
        </div>
    </div>
</nav>

 <section class="section section-lg section-shaped">
    <div class="shape shape-style-1 shape-default">
      <span></span>
      <span></span>
      <span></span>
      <span></span>
      <span></span>
      <span></span>
      <span></span>
      <span></span>
    </div>
   


<!--Modal: modalRelatedContent-->
<div class="modal fade right" id="modalRelatedContent" tabindex="-1" role="dialog"
  aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="false">
  <div class="modal-dialog modal-side modal-bottom-right modal-notify modal-info" role="document">
    <!--Content-->
    <div class="modal-content">
      <!--Header-->
      <div class="modal-header">
        <p class="heading">BOOKED TICKETS</p>

        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true" class="white-text">&times;</span>
        </button>
      </div>

      <!--Body-->
      <div class="modal-body">
        {% for x,y,z,l,name,src in booked %}
        <div class="row">
          <div class="col-5">
            <img src="{{src}}"class="img-fluid" alt="">
          <div style="position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
">
          <img src="{% static "/images/paid.gif" %}"  height="100px" width="200px">
  </div>
          </div>
          <div class="col-7">
            <p><strong>{{name}}</strong></p>
            <p>{{x}}</p>
            <p><b>SEATS</b>{{z}}</p>
            <p>{{y}}</p>
            <B>AMOUNT</B>
            <button type="button" class="btn btn-info btn-md">
            {{l}}
            </button>
          </div>
        </div>
       <br>
      <br>
         {% endfor %}
      </div>
    </div>
    <!--/.Content-->
  </div>
</div>

    <div class="container py-md" >
      <div class="row row-grid justify-content-between align-items-center">
        <div class="col-lg-6">
          <h3 class="display-3 text-white">QUICK BOOK<span class="text-white">BOOK TICKETS</span></h3>
          <p class="lead text-white">
            Because I wanted to have a place that I could create everything that I that I never had as a child. So, you see rides. You see animals. There's a movie theater.
          </p>
          <div class="btn-wrapper">
                       <select id="locationdetect" onchange="getmovies('locationdetect')" class="custom-select -sm">             
  <option selected disabled>SELECT LOCATION</option>
     {% for col,loc in  locations %}
    <option value="{{loc}}">{{col}}</option>
    {% endfor %}
</select>
<script type="text/javascript">
  function getmovies(id)
  {
    var value=document.getElementById(id).value; 
   window.location.href='https://quickbookindia.herokuapp.com/getmovies?locationid='+value;
  }
</script>
        </div>
        </div>
      </div>
    </div>
    <!-- SVG separator -->
    <div class="separator separator-bottom separator-skew">
      <svg x="0" y="0" viewBox="0 0 2560 100" preserveAspectRatio="none" version="1.1" xmlns="http://www.w3.org/2000/svg">
        <polygon class="fill-white" points="2560 0 2560 100 0 100"></polygon>
      </svg>
    </div>
  <br>
  <div class="container p-3 my-3 bg-primary text-white"  id="bookticket">
  {% if not movies %}
   <div class="row justify-content-between align-items-center" id="intial">
  <div class="col" style=" margin: 0 auto; text-align: center;">
  <h2>please select your region</h2>
  </div>
<div id="carousel_example" class="carousel slide" data-ride="carousel">
              <ol class="carousel-indicators">
                <li data-target="#carousel_example" data-slide-to="0" class="active"></li>
                <li data-target="#carousel_example" data-slide-to="1"></li>
                <li data-target="#carousel_example" data-slide-to="2"></li>
              </ol>
              <div class="carousel-inner">
                <div class="carousel-item active">
                  <img class="img-fluid" src="{% static "/assets/img/theme/MASTER.jpg" %}" alt="First slide">
                </div>
                <div class="carousel-item">
                  <img class="img-fluid" src="{% static "/assets/img/theme/AVENGERS.jpg" %}" alt="Second slide">
                </div>
                <div class="carousel-item">
                  <img class="img-fluid" src="{% static "/assets/img/theme/KGF.jpg" %}" alt="Third slide">
                </div>
              </div>
              <a class="carousel-control-prev" href="#carousel_example" role="button" data-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="sr-only">Previous</span>
              </a>
              <a class="carousel-control-next" href="#carousel_example" role="button" data-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="sr-only">Next</span>
              </a>
            </div>
</div>
{% endif %}
  <div class="row">
    <div class="w-100"></div>

 {% if movies == "no" %}
      <h1>NO MOVIES SCREENING NEAR YOU</h1>
{% else %}
    <br>
    {% for img,name in movies %}
    <div class="col-sm-3">
        <span>
            <img src="{{img}}" id="src{{name}}" class="img-thumbnail" height="200px">
            <div style="position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
"><button  type="button" class="btn btn-secondary" style="display: block;" onclick="getname('{{name}}','{{currentlocation}}')" id="{{name}}">{{name}}</button>
<img id="loading{{name}}" style="display: none;" src="{% static "/images/spinner.gif" %}">
</div>
    </span>
    </div>
    {% endfor %}
{% endif %}     
  </div>
</div>
</section>
  <script type="text/javascript">
    function getname(name,locations)
    {
      document.getElementById("finalmoviename").value=name; 
      var load="loading"+name;
     var srcname="src"+name;
     document.getElementById(name).style.display="none"; 
    document.getElementById(load).style.display="block"; 
    var valueofsrc=document.getElementById(srcname).src;
     document.getElementById("hiddenmoviename").value=valueofsrc; 
$.ajax({
  type: 'post',
  url: '/getscreening/',
  data: {
  moviename:name,
  locationid:locations
  },
    success: function (response) {  
     if(response!="NO"&&response!="[]") 
   {
    $('#TIMINGS').children('option:not(:first)').remove();
  var counts = JSON.parse(response);
  var x = document.getElementById("TIMINGS");
  var length=counts.length;
  var i=0;
  var date;
  for (var y of counts) { 
  if(i==(length-1))
  {
date=y;
  }
  else
  {
  var option = document.createElement("option");
  option.text =y;
  option.value=y;
  x.add(option);
    }
    i++;
  }
  var today = new Date();
var dd = today.getDate();
var mm = today.getMonth()+1; //January is 0!
var yyyy = today.getFullYear();
 if(dd<10){
        dd='0'+dd
    } 
    if(mm<10){
        mm='0'+mm
    } 
today = yyyy+'-'+mm+'-'+dd;
var end=new Date(date);
var dd = end.getDate();
var mm = ("0" + (end.getMonth() + 1)).slice(-2); //January is 0!
var yyyy = end.getFullYear();
end = yyyy+'-'+mm+'-'+dd;
document.getElementById("dateofmovie").setAttribute("min", today);
document.getElementById("dateofmovie").setAttribute("max", end);
      document.getElementById("dateofmovie").value=today;
      document.getElementById("nameofmovie").innerHTML=name+" SCREENING(FROM "+today+" UPTO "+end+" )";
      document.getElementById(name).style.display="block"; 
    document.getElementById(load).style.display="none"; 
                 $('#showscreen').modal({backdrop: 'static', keyboard: false});  
           $('#showscreen').modal('show');  
  }
    else
    {
       document.getElementById(name).style.display="block"; 
    document.getElementById(load).style.display="none"; 
      alert("no shows detected");
    }
  },
  error: function (jqXHR, textStatus, errorThrown) 
{ 
    document.getElementById(name).style.display="block"; 
    document.getElementById(load).style.display="none"; 
  alert("please try after sometime");
}
});

    }
  </script>
 

 <div class="modal fade bd-example-modal-lg" id="showscreen" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="nameofmovie"></h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
   <div class="modal-body" id="groupdate">
     <div class="input-group">
      <input type="hidden" id="hiddenmoviename">
      <select id="TIMINGS" class="custom-select -sm" >
        <option value="no">select your TIMINGS</option>
      </select>
    </div>
   
  <br>
    <div class="form-group">
  <div class="input-group">
    <div class="input-group-prepend">
      <span class="input-group-text"><i class="ni ni-calendar-grid-58"></i></span>
    </div>
    <form>
    <input class="flatpickr flatpickr-input form-control" id="dateofmovie" max="" min="" type="date" placeholder="Select Date.." required="" required>
  </form>
  </div>
</div>

    </div>


<div class="modal-body" id="showsheets" style="display: none;">
    <div class="input-group">
  <br>
      <select id="noofseats" class="custom-select -sm">
        <option value="none" selected disabled>select no of seats</option>
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5</option>
        <option value="6">6</option>
      </select>
  </div>
  <h4 id="dateandtimedisplay" class="display-4"></h4>
<div class="table-responsive" id="showscreenoftime">
<img id="loaderscreen" src="{% static "/images/showseat.gif" %}" style="padding-left: 70px;">
  <table style="width: 600px;
  height: 600px;
  overflow: auto;

margin:auto;
display: none;
  " cellspacing="10" id="screener">
    <thead>
    </thead>
    <tbody>
      <tr>
      <td></td>
      {% for col in loop %}
              <td><b>{{ col }}</b></td>
      {% endfor %}
        </tr>
      {% for col in loopinrow %}  
          {% if col == "l" %}
            <tr>
            {% for ret in loop %}
                <td> </td>
            {% endfor %}
            </tr>
            {% endif %} 
           <tr>
          <td><b>{{col}}</b></td>
         {% for ret in loop %}
              <td id="{{col}}{{ret}}" onclick="getfill('{{col}}{{ret}}')" style="color:#4655ff;" ><i  class="fas fa-couch"></i></td>
      {% endfor %}
        </tr>
     {% endfor %}
    <br>
    <tr>
        <td style="background-color: blue;color: white; text-align: center" colspan="100%">SCREEN THIS WAY</td>
      </tr>
    </tbody>
</table>
<h1 class="display-4">NOTE:seats l-o rows cost:60<br>
a-k costs:190
</h1>




<script type="text/javascript">
  function getfill(id)
  {
    if(document.getElementById(id).style.color=="red")
        document.getElementById(id).style.color=="red"
    else if(document.getElementById(id).style.color=="green")
      document.getElementById(id).style.color="#4655ff";
    else
      document.getElementById(id).style.color="green";
      
  }
</script>
</div>

<div id="paymentbutton" style="display: none;">
        <div style="margin: auto;
  width: 50%;
  border: 3px solid green;
  padding: 10px;">
        <span >
            <img id="movieposteronpayment" src="" class="img-thumbnail">
            <div  style="position: absolute !important;
  top: 50% !important;
  left: 50%;
  transform: translate(-50%, -50%) !important;
" ><button  type="button" id="seatnos" class="btn btn-secondary"></button>
         <img src="{% static "/images/paid.gif" %}"  height="100px" width="200px" id="paidpic" style="display: none;">
</div>
    </span>
</div>
<br>
              <div class="alert alert-info" id="walletbalance" role="alert">
              YOUR WALLET BALANCE IS:{{wallet}}
              </div>
              <ul class="nav nav-pills nav-stacked">
                <li class="active">
                  <button class="btn btn-primary" >
                  <span class="badge pull-right" id="amount"><span class="glyphicon glyphicon-usd"></span></span> Final Payment</button>
                </li>
            </ul>
            <br/>
            <button href="" onclick="pay();" class="btn btn-success btn-lg btn-block"  id="finalpayment" role="button">Pay
            </button>
            <div class="progress-wrapper" id="progressbarofpayment"style="display: none">
  <div class="progress-info">
    <div class="progress-label">
      <span>PAYMENT PROGRESS</span>
    </div>
    <div class="progress-percentage" id="denotepercentage">
      <span></span>
    </div>
  </div>
  <div class="progress">
    <div class="progress-bar bg-primary" id="barpercentage" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" ></div>
  </div>
</div>
<input type="hidden" id="timendscreen">
<input type="hidden" id="finaldate">
<input type="hidden" id="finalseatselection">
<input type="hidden" id="finalmoviename">
<input type="hidden" id="casher">
      </div>
   </div>    
    <div class="modal-footer">

     <button type="button" class="btn btn-primary" id="seatselection" onclick="viewseats()">    
                      SELECT SEATS</button>
     <button type="button" class="btn btn-primary" style="display: none;" id="payment" onclick="confirmseats()">    
                      CONFIRM SEATS</button>
                 <button type="button" class="btn btn-primary"  style="float: left;display: none;" id="goback" onclick="gobackto()">
                   GOBACK
                 </button>
                 </div>
    </div>
  </div>
</div>

<script type="text/javascript">
  
    function pay()
    {
      var alertcvv=prompt("ENTER YOUR PASSWORD");
document.getElementById("progressbarofpayment").style.display="block";
document.getElementById("denotepercentage").innerHTML="0%";
document.getElementById("barpercentage").style.width="0%";
document.getElementById("paidpic").style.display="none";
     if(alertcvv === "{{password}}" )
     {
      var time=document.getElementById("timendscreen").value;
   var date=document.getElementById("finaldate").value;
   var seats=document.getElementById("finalseatselection").value;
   var mov=document.getElementById("finalmoviename").value;
 var casher=document.getElementById("casher").value;
  var srcvalue=document.getElementById("hiddenmoviename").value;
$.ajax({
  type: 'post',
  url: '/checkseats/',
  data: {
   timeandscreen:time,
   sdate:date,
   name:mov,
   sseats:seats,
   cash:casher,
   src:srcvalue
  },
    success: function (response) {  
setTimeout(3000);
   if(response=="ok") 
   {
    var i=0;
    if (i == 0) {
    i = 1;
    var elem = document.getElementById("barpercentage");
    var elemenet=document.getElementById("denotepercentage");
    var width = 1;
    var id = setInterval(frame, 10);
    function frame() {
      if (width >= 50) {
        clearInterval(id);
        i = 0;
      } else {
        width++;
        elem.style.width = width + "%";
        elemenet.innerHTML=width+ "%";
      }
    }
  }
document.getElementById("paidpic").style.display="block";
document.getElementById("finalpayment").disabled=true;
$.ajax({
  type: 'post',
  url: '/sendseattomob/',
  data: {
   timeandscreen:time,
   sdate:date,
   name:mov,
   sseats:seats,
   cash:casher,
   src:srcvalue
  },
    success: function (response) {  
setTimeout(3000);
   if(response=="OK") 
   {
   var i=50;
    if (i == 50) {
    i = 1;
    var elem = document.getElementById("barpercentage");
    var elemenet=document.getElementById("denotepercentage");
    var width = 1;
    var id = setInterval(frame, 10);
    function frame() {
      if (width >= 100) {
        clearInterval(id);
        i = 0;
      } else {
        width++;
        elem.style.width = width + "%";
        elemenet.innerHTML=width+ "%";
      }
    }
  }
   }
   else
   {
    alert("ticket details not send to mobile please view ticket session");
   }
}
,
error: function (jqXHR, textStatus, errorThrown) 
{ 
         alert('some error on sending tickete details');
}
});

   alert("seats booked successfully LOOK TICKET SESSION FOR TICKETS");
  return true;  
   }
   else
   {
    alert("SEATS soldout");
   return false;
   }
 }
,
error: function (jqXHR, textStatus, errorThrown) 
{ 
         alert('some error please try after sometime');
}
});
  

     } 
     else
     {
  document.getElementById("progressbarofpayment").style.display="none";
      alert("invalid cvv");
     }
    }

  function confirmseats()
  {
var no=document.getElementById("noofseats").value;
  if(no=="none")
  {
    alert("please select no of seats and proceed");
  }
  else  
  {
    var array=[];
{% for col in loopinrow %}  
       {% for ret in loop %}
      if(document.getElementById("{{col}}{{ret}}").style.color=="green")
      {
          array.push("{{col}}{{ret}}");
      }   
{% endfor %}
{% endfor %}
var cash=0;
for (index = 0; index < array.length; index++) { 
     if(array[index].includes("l")||array[index].includes("m")||array[index].includes("n")||array[index].includes("o")) 
        cash=cash+60;
     else
        cash=cash+190; 
} 
  if(array.length==no)
  {
    alert("SLECTED SEATS"+array);
    if(confirm("DO YOU WISH TO CONTINUE TO PAYMENT"))
      {
  document.getElementById("finalseatselection").value=array; 
        document.getElementById("seatnos").innerHTML=array;
        document.getElementById("showscreenoftime").style.display="none";
         document.getElementById("payment").disabled=true;
         document.getElementById("noofseats").style.display="none";
         document.getElementById("paymentbutton").style.display="block";
        document.getElementById("amount").innerHTML="RS"+cash;
       var srcvalue=document.getElementById("hiddenmoviename").value;
        document.getElementById("movieposteronpayment").src=srcvalue;
        document.getElementById("casher").value=cash;
        if("{{wallet}}"<cash)
        {
       var remain=cash-"{{wallet}}";
       document.getElementById("walletbalance").innerHTML="YOUR WALLET BALANCE IS LOW : ADD RS"+ remain+"  TO YOUR WALLET FOR CHECKOUT";   
       document.getElementById("finalpayment").disabled=true;
        }
        else
        {
       var BALANCE="{{wallet}}";   
          document.getElementById("walletbalance").innerHTML="YOUR WALLET BALANCE IS:"+BALANCE;
document.getElementById("finalpayment").disabled=false;
        }
    }
  }
  else
  {
    alert(" you have selected "+array.length+" seats "+" please select "+no+"s eats");
  }
  }
  }
  function gobackto()
  {
   document.getElementById("groupdate").style.display="block";
    document.getElementById("showsheets").style.display="none";
    document.getElementById("seatselection").style.display="block";
    document.getElementById("payment").style.display="none"; 
    document.getElementById("goback").style.display="none"; 
  document.getElementById("screener").style.display="none";  
  document.getElementById("loaderscreen").style.display="block";
  }

  function viewseats()
  {
       document.getElementById("showscreenoftime").style.display="block";
       document.getElementById("payment").disabled=false;
        document.getElementById("noofseats").style.display="block";
          document.getElementById("paymentbutton").style.display="none";
     var time=document.getElementById("TIMINGS").value;
    var dofm=document.getElementById("dateofmovie").value;
  document.getElementById("timendscreen").value=time; 
  document.getElementById("finaldate").value=dofm; 
if(time=="no")
{
  alert("Invalid details/date");
}
else
{
    document.getElementById("dateandtimedisplay").innerHTML=dofm+" SHOW TIME"+time;
    document.getElementById("groupdate").style.display="none";
    document.getElementById("showsheets").style.display="block";
    document.getElementById("seatselection").style.display="none";
    document.getElementById("payment").style.display="block";
     document.getElementById("goback").style.display="block"; 
   $.ajax({
  type: 'post',
  url: '/getscreendetails/',
  data: {
 screenandtime: time,
 moviedate:dofm,
  },
    success: function (response) {  
     if(response!="[]") 
   {
 response=response.slice(1,-1);
var counts=JSON.parse(response);
  {% for col in loopinrow %}  
       {% for ret in loop %}
      document.getElementById("{{col}}{{ret}}").style.color="#4655ff";    
        {% endfor %}
        {% endfor %}
  for (var y of counts) 
  {   
    console.log(y);
 document.getElementById(y).style.color="red";  
}
   document.getElementById("loaderscreen").style.display="none";
 document.getElementById("screener").style.display="block";  

  }
  else
  {
{% for col in loopinrow %}  
       {% for ret in loop %}
      document.getElementById("{{col}}{{ret}}").style.color="#4655ff";    
        {% endfor %}
        {% endfor %}
      document.getElementById("loaderscreen").style.display="none";
 document.getElementById("screener").style.display="block";  
  }
},
error: function (jqXHR, textStatus, errorThrown) 
{
       document.getElementById("loaderscreen").style.display="none";
alert("server timedout try again");
}
}
);
   }
  }
</script>
          
  <!-- End Navbar -->
        
          <div class="modal fade" id="modal-default" tabindex="-1" role="dialog" aria-labelledby="modal-default" aria-hidden="true">
            <div class="modal-dialog modal- modal-dialog-centered modal-" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h6 class="modal-title" id="modal-title-default">CHANGE PASSWORD</h6>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">Ã—</span>
                  </button>
                </div>
                <div class="modal-body"  id="change_psw1" style="display: block;">
                <input type="PASSWORD" id="change_psw"  class="form-control" placeholder="Please enter your OLD PASSWORD">
                </div>
                <div class="modal-body" id="change_psw2" style="display: none;">
                <input type="hidden"  class="form-control" id="token" placeholder="ENTER TOKEN VALUE SEND TO YOUR EMAIL">
                <input type="text"  class="form-control" id="tokenorg" placeholder="TOKEN VALUE"><br>
                <input type="PASSWORD"  id="pw1" class="form-control" placeholder="Please enter your NEW PASSWORD"><br>
                <input type="PASSWORD" id="pw2" class="form-control" placeholder="Please Re-enter your PASSWORD"><br>
                 <div class="text-muted font-italic"><small>password strength: <span class="text-success font-weight-700" id="suc" style="display: none;">strong</span>
<span class="text-success font-weight-700" id="weak" style="color:red !important;display: none;">weak</span>
<span class="text-success font-weight-700" id="moderate" style="color:orange !important;display: none;">moderate</span>
                  </small>
                </div>
                
                <div class="text-muted font-italic"><small>password MATCH: <span class="text-success font-weight-700" id="checkpw21" style="display: none;">MATCHED</span>
<span class="text-success font-weight-700" id="checkpw22" style="color:red !important;display: none;">DOESNT MATCH</span>
                  </small>
                </div>
                
                </div>
                                 <div class="modal-footer">
<button type="button" class="btn btn-primary" style="display: none;" id="cursend">
                  <img src="{% static "assets/img/brand/30.gif" %}" height="10px">SENDING EMAIL...</button>
                  <button type="button" class="btn btn-primary" id="curselection" onclick="changepassword();">    
                      change password</button>
                   <button type="button" class="btn btn-primary" style="display: none;" id="after_selection" onclick="checkchanges()">Save changes</button>
                  <button type="button" class="btn btn-primary" style="display: none;" id="updatepassword">
                  <img src="{% static "assets/img/brand/30.gif" %}" height="10px">UPDATING PASSWORD...</button>


                  <button type="button" class="btn btn-link  ml-auto" data-dismiss="modal">Close</button>
                </div>
              </div>
            </div>
          </div>
      <script type="text/javascript">
        function checkchanges()
        {
 var token=document.getElementById("token").value;
        var tokenorginal=document.getElementById("tokenorg").value;
        var password=document.getElementById("pw1").value;
                  document.getElementById("after_selection").style.display="none";
            document.getElementById("updatepassword").style.display="block";
          if(token==tokenorginal&&document.getElementById("checkpw21").style.display=="block"&&document.getElementById("suc").style.display=="block")
          {
        alert(password);      
  $.ajax({
  type: 'post',
  url: '/updatepsw/',
  data: {
    email:"{{email}}",
    psw:password,
   },
    success: function (response) {  
     if(response=="ok") 
   {
           document.getElementById("after_selection").style.display="block";
            document.getElementById("updatepassword").style.display="none";
            alert('updated you will be logged out now');
       window.location.href='https://quickbookindia.herokuapp.com/LOGOUT';
       return true;
  }
  else
  {
    document.getElementById("after_selection").style.display="block";
            document.getElementById("updatepassword").style.display="none";
    return false;
  }
},
error: function (jqXHR, textStatus, errorThrown) 
{ 
   document.getElementById("after_selection").style.display="block";
            document.getElementById("updatepassword").style.display="none";
          alert('some error in upadting please try after sometime');
}
});

          }
          else
          {
            document.getElementById("after_selection").style.display="block";
            document.getElementById("updatepassword").style.display="none";
            alert("please fill valid credentials or token is invalid");
          }
    }
var myInput1 = document.getElementById("pw1");
var myInput2= document.getElementById("pw2");
myInput1.onkeyup = function() {
  // Validate lowercase letters
  var lowerCaseLetters = /[a-z]/g;
  // Validate capital letters
  var upperCaseLetters = /[A-Z]/g;
  // Validate numbers
  var numbers = /[0-9]/g;
    
  if(myInput1.value.match(lowerCaseLetters)||myInput1.value.match(upperCaseLetters)||myInput1.value.match(numbers))
  {
   document.getElementById("weak").style.display = "block";  
   document.getElementById("suc").style.display = "none";  
   document.getElementById("moderate").style.display = "none";  
  }
  else
  {
   document.getElementById("weak").style.display = "none";    
  }
  if((myInput1.value.match(lowerCaseLetters)&&myInput1.value.match(upperCaseLetters))||(myInput1.value.match(lowerCaseLetters)&&myInput1.value.match(numbers))||(myInput1.value.match(upperCaseLetters)&&myInput1.value.match(numbers)))
  {
   document.getElementById("weak").style.display = "none";  
   document.getElementById("suc").style.display = "none";  
   document.getElementById("moderate").style.display = "block";  
  }
  else
  {
   document.getElementById("moderate").style.display = "none";    
  }
  if((myInput1.value.length >= 8)&&(myInput1.value.match(lowerCaseLetters))&&(myInput1.value.match(upperCaseLetters))&&(myInput1.value.match(numbers)))
  {
   document.getElementById("suc").style.display = "block"; 
   document.getElementById("weak").style.display = "none";  
   document.getElementById("moderate").style.display = "none";  
  }
  else 
  {
   document.getElementById("suc").style.display = "none"; 
    }
  
}

myInput2.onkeyup = function() {
var c_pas = document.getElementById("pw1").value;  
if(myInput2.value.match(c_pas)&&(c_pas))
{
   document.getElementById("checkpw22").style.display = "none"; 
  document.getElementById("checkpw21").style.display = "block";
}
 else 
  {
      document.getElementById("checkpw22").style.display = "block"; 
  document.getElementById("checkpw21").style.display = "none";
    }

}



        function makeid(length) {
   var result           = '';
   var characters       = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
   var charactersLength = characters.length;
   for ( var i = 0; i < length; i++ ) {
      result += characters.charAt(Math.floor(Math.random() * charactersLength));
   }
   return result;
}
        function changepassword()
        {
          var psw=document.getElementById("change_psw").value;
          if(psw=='{{password}}')
          {
            document.getElementById("curselection").style.display="none";
            document.getElementById("cursend").style.display="block";
               var token=makeid(8);
            $.ajax({
  type: 'post',
  url: '/sendemail/',
  data: {
    tokens:token,
    email:"{{email}}",
   },
    success: function (response) {  
     if(response=="ok") 
   {
       document.getElementById("token").value=token;
     document.getElementById("cursend").style.display="none";
        document.getElementById("after_selection").style.display="block";
          document.getElementById("change_psw1").style.display="none";
          document.getElementById("change_psw2").style.display="block";
    return true;
  }
  else
  {
      document.getElementById("cursend").style.display="none";
            document.getElementById("curselection").style.display="block";
            document.getElementById("cursend").style.display="none";
      alert('server busy try after some time');
    return false;
  }
},
error: function (jqXHR, textStatus, errorThrown) 
{ 
      document.getElementById("cursend").style.display="none";
            document.getElementById("curselection").style.display="block";
            document.getElementById("cursend").style.display="none";
  alert('connot send mail'); 
}
});
      }
          else
          {
            alert('password didnt match with our records');
          }
        }
      </script>
    
    <footer class="footer" style="position: fixed;
left: 0;
bottom: 0;
height: 10px;
width:100%;
text-align: center;
background-color:#f4f5f7;
">
     <h6 >QUICK BOOK</h6>
    </footer>
         <div class="modal fade" id="modal-notification" tabindex="-1" role="dialog" aria-labelledby="modal-notification" aria-hidden="true">
            <div class="modal-dialog modal-danger modal-dialog-centered modal-" role="document">
              <div class="modal-content bg-gradient-danger">
                <div class="modal-header">
                  <h6 class="modal-title" id="modal-title-notification">   Your attention please verify your phone number  </h6>
                </div>
                <div class="modal-body"style="display: block;" id="checkverify">
                  <div id="content-sms"  class="py-3 text-center">
                    <i class="ni ni-bell-55 ni-3x"></i>
                    <h4 class="heading mt-4">You should read this!</h4>
                    <p>PLEASE VERIFY YOUR MOBILE NUMBER REGISTERED WITH US </p>
                      <h4 class="heading mt-4">CLICK BELOW TO VERIFY!</h4>
                   OR
                   <a href="\LOGOUT\" class="btn btn-neutral btn-icon">
              <span class="btn-inner--icon">
                <i class="ni ni-curved-next"></i>
              </span>
              <span class="nav-link-inner--text">LOGOUT</span>
            </a>
          
                  </div>
                </div>
               <div class="modal-body" style="display: none;" id="checkotp">
                <div id="content-mobile"  class="py-3 text-center">
                    <i class="ni ni-bell-55 ni-3x"></i>
                    <h4 class="heading mt-4">PLEASE ENTER OTP SEND TO YOUR MOBILE</h4>
                    <p><input type="number" required id="validateotp" > </p>
                      <p>note:all otps will expire after the time runsUP</p>
                         OR
                   <a href="\LOGOUT\" class="btn btn-neutral btn-icon">
              <span class="btn-inner--icon">
                <i class="ni ni-curved-next"></i>
              </span>
              <span class="nav-link-inner--text">LOGOUT</span>
            </a>
                      <button type="button" onclick="checkotpofclient()" class="btn btn-white">submit</button>
                       <img src="{% static "assets/img/brand/loading.gif" %}" height="50px" width="50px" id="changeloadinside" style="display: none;">
                  </div>
                </div>
                <div class="modal-footer">
                  <button type="button" onclick="sendsms();" id="ver" style="display: block;"class="btn btn-white">VERIFY</button>
                   <button type="button" class="btn btn-white" id="send" style="display: none;">   <img src="{% static "assets/img/brand/30.gif" %}" height="10px"> SENDING</button>
                  <button type="button" onclick="changemobile()" class="btn btn-link text-white ml-auto">CHANGE MOBILENO  <img src="{% static "assets/img/brand/loading.gif" %}" height="50px" width="50px" id="changeload" style="display: none;">
               </button> 
                </div>
              </div>
            </div>
          </div>
 <!--   Core JS Files   -->

  <script src="{% static "/assets/js/core/jquery.min.js" %}"type="text/javascript"></script>
  <script src="{% static "/assets/js/core/popper.min.js" %}" type="text/javascript"></script>
  <script src="{% static "/assets/js/core/bootstrap.min.js" %}" type="text/javascript"></script>
  <script src="{% static "/assets/js/plugins/perfect-scrollbar.jquery.min.js" %}"></script>
  <!--  Plugin for Switches, full documentation here: http://www.jque.re/plugins/version3/bootstrap.switch/ -->
  <script src="{% static "/assets/js/plugins/bootstrap-switch.js"></script>
  <!--  Plugin for the Sliders, full documentation here: http://refreshless.com/nouislider/ -->
  <script src="{% static "/assets/js/plugins/nouislider.min.js" %}"type="text/javascript"></script>
  <script src="{% static "/assets/js/plugins/moment.min.js" %}"></script>
  <script src="{% static "/assets/js/plugins/datetimepicker.js" %}" type="text/javascript"></script>
  <script src="{% static "/assets/js/plugins/bootstrap-datepicker.min.js" %}"></script>
  <!-- Control Center for Argon UI Kit: parallax effects, scripts for the example pages etc -->
  <!--  Google Maps Plugin    -->
      <script src="https://apis.google.com/js/platform.js" async defer></script>
  <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_KEY_HERE"></script>
  <script src="{% static "/assets/js/argon-design-system.min.js" %}" type="text/javascript"></script>
<script src='https://kit.fontawesome.com/a076d05399.js' ></script>
  
  <script>
    $(window).on('load',function(){
      if('{{verify}}'=='false')
      {
        $('#modal-notification').modal({backdrop: 'static', keyboard: false});  
        $('#modal-notification').modal('show');
      }           
      document.getElementById("totalnoofticketsbooked").innerHTML={{count}};
    });

    window.TrackJS &&
      TrackJS.install({
        token: "ee6fab19c5a04ac1a32a645abde4613a",
        application: "argon-design-system-pro"
      });
  function signOut() {
    var auth2 = gapi.auth2.getAuthInstance();
auth2.signOut().then(function () {
});
    }
    function sendsms()
    {
        document.getElementById("send").style.display="block";
        document.getElementById("ver").style.display="none";
 $.ajax({
  type: 'post',
  url: '/sendsms/',
  data: {
   MOBILE:'{{mobile}}',
  },
    success: function (response) {
    console.log(response);  
    if(response=="OK") 
   {
        document.getElementById("send").style.display="none";
        document.getElementById("ver").style.display="block";
               document.getElementById("checkverify").style.display="none";    
        document.getElementById("checkotp").style.display="block";
    var dt = new Date();
 dt.setMinutes( dt.getMinutes() + 2 );

// Update the count down every 1 second
var x = setInterval(function() {

  // Get todays date and time
  var now = new Date().getTime();
    
  // Find the distance between now and the count down date
  var distance = dt - now;
    
  // Time calculations for days, hours, minutes and seconds
  var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
  var seconds = Math.floor((distance % (1000 * 60)) / 1000);
    
  // Output the result in an element with id="demo"
  document.getElementById("ver").innerHTML = minutes + "m " + seconds + "s ";
  document.getElementById("ver").disabled=true;
  // If the count down is over, write some text 
  if (distance < 0) {
    clearInterval(x);
   $.ajax({
  type: 'post',
  url: '/deleteotp/',
  data: {
   email:'{{email}}',
  },
    success: function (response) {
    console.log(response);  
    if(response=="ok") 
   {
   document.getElementById("ver").innerHTML = "EXPIRED";
  location.reload();  
   return true;
   }
   else
   {
 document.getElementById("ver").innerHTML = "please reload page";
    return false;
   }
 }}); 
}
}, 1000);

    return true;
   }
   else
   {
    alert("some error happened please try again after some time");
    return false;
   }
}
});
    }

    function checkotpofclient()
    {
      document.getElementById("changeloadinside").style.display="inline";
    psw=document.getElementById("validateotp").value;
    $.ajax({
  type: 'post',
  url: '/validateotp/',
  data: {
   otp:psw,
   email:'{{email}}',
  },
    success: function (response) {
    console.log(response);  
    if(response=="OK") 
   {
      document.getElementById("changeloadinside").style.display="none";
      alert('VERFIED YOU WILL BE LOGGED OUT NOW');
     window.location.href='https://quickbookindia.herokuapp.com/LOGOUT';
    return true;
   }
   else if(response=="fail") 
   {
     document.getElementById("changeloadinside").style.display="none";
    alert('otp valid but server busy');
    return false;
   }
   else
   {
     document.getElementById("changeloadinside").style.display="none";
    alert('invalid otp');
    return false;
   }
 }}); 
    }

    function changemobile()
    {
      if(confirm("please enter 10 digit phone no"))
      {
          var person = prompt("Please enter your MOBILENO");
          document.getElementById("changeload").style.display="inline";
          if (person != null&&person.length==10&&person!={{mobile}}) 
          {
          $.ajax({
  type: 'post',
  url: '/changemobile/',
  data: {
   mobile:person,
   email:'{{email}}',
  },
    success: function (response) {
    console.log(response);  
    if(response=="OK") 
   {
    document.getElementById("changeload").style.display="none";
      alert('YOUR PHONE NUMBER CHANGED :YOU WILL BE LOGGED OUT NOW');
     window.location.href='https://quickbookindia.herokuapp.com/LOGOUT';
    return true;
   }
   else
   {
     document.getElementById("changeload").style.display="none";
    alert('SERVER BUSY');
    return false;
   }
 }});
           }
          else
          {
             document.getElementById("changeload").style.display="none";
            alert("please enter ten digits or number already in use");
          }
      }
    }
  
  </script>
</body>
</html>
